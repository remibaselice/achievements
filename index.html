<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Achievement Tracker</title>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #121212;
    color: white;
}

#topBar {
    display: flex;
    justify-content: center;
    gap: 60px;
    padding: 20px;
    border-bottom: 1px solid #333;
}

#container {
    display: flex;
    height: calc(100vh - 80px);
}

#games {
    width: 300px;
    border-right: 1px solid #333;
    padding: 10px;
}

.game {
    padding: 10px;
    border-radius: 6px;
    cursor: pointer;
    margin-bottom: 6px;
}

.game:hover { background:#2a2a2a; }
.selected { background:#444; }

button {
    width:100%;
    margin-top:5px;
}

#noGames {
    text-align:center;
    margin-top:40px;
    color:#777;
}

#achievements {
    flex:1;
    padding:20px;
}

.achievement {
    background:#1f1f1f;
    padding:10px;
    border-radius:6px;
    margin-bottom:10px;
    border:3px solid gray;
    position: relative;
}

.small {
    font-size:12px;
    color:#aaa;
}

.bronze { border-color:#cd7f32; }
.silver { border-color:#c0c0c0; }
.gold { border-color:#ffd700; }
.platinum { border-color:#00ffff; }

select {
    margin-top:6px;
}

.deleteAch {
    float:right;
    cursor:pointer;
    color:red;
}

/* Achievement button */
.achieveBtn {
    position: absolute;
    right: 10px;
    top: 10px;
    width: 20px;
    height: 20px;
    background-color: white;
    border: 1px solid #000;
    cursor: pointer;
}

.achieveBtn.clicked {
    background-color: red;
}
</style>
</head>

<body>

<div id="topBar">
<span id="bronzeCounter">Bronze: 0</span> • 
<span id="silverCounter">Silver: 0</span> • 
<span id="goldCounter">Gold: 0</span> • 
<span id="platinumCounter">Platinum: 0</span>
</div>

<div id="container">

<div id="games">
    <!-- Save/Load Buttons -->
    <button onclick="saveToPassword()">Save Data</button>
    <button onclick="loadFromPassword()">Load Data</button>
    <button onclick="addGame()">+ Add Game</button>
    <button onclick="deleteGame()">Delete Selected</button>
    <div id="gameList"></div>
    <div id="noGames" style="display:none;">No games available</div>
</div>

<div id="achievements">
<button onclick="addAchievement()">+ Add Achievement</button>
<div id="achList"></div>
</div>

</div>

<script>

// Default Achievements
const defaultAchievements = [
    {name:"Bronze",how:"Complete something basic",tier:"bronze"},
    {name:"Silver",how:"Go a little further",tier:"silver"},
    {name:"Gold",how:"Do something impressive",tier:"gold"},
    {name:"Platinum",how:"Perfect completion",tier:"platinum"}
];

// Load from localStorage
let games = JSON.parse(localStorage.getItem("games")) || {
    "Mario Kart World": JSON.parse(JSON.stringify(defaultAchievements))
};

let selectedGame=null;

// Save to localStorage
function save(){
    localStorage.setItem("games",JSON.stringify(games));
}

// Render Games
function renderGames(){
    const list=document.getElementById("gameList");
    list.innerHTML="";

    const keys=Object.keys(games);

    if(keys.length===0){
        document.getElementById("noGames").style.display="block";
        document.getElementById("achList").innerHTML="";
        updateTopBarCounters();
        return;
    }

    document.getElementById("noGames").style.display="none";

    keys.forEach(k=>{
        const d=document.createElement("div");
        d.className="game"+(k===selectedGame?" selected":"");
        d.textContent=k;
        d.onclick=()=>selectGame(k);
        list.appendChild(d);
    });

    if(!selectedGame) selectGame(keys[0]);
}

function selectGame(name){
    selectedGame=name;
    renderGames();
    renderAchievements();
}

// Add/Delete Games
function addGame(){
    const name=prompt("Game name?");
    if(!name) return;
    games[name]=JSON.parse(JSON.stringify(defaultAchievements));
    selectedGame=name;
    save();
    renderGames();
    renderAchievements();
}

function deleteGame(){
    if(!selectedGame) return;
    delete games[selectedGame];
    selectedGame=null;
    save();
    renderGames();
    updateTopBarCounters();
}

// Render Achievements
function renderAchievements(){
    const wrap=document.getElementById("achList");
    wrap.innerHTML="";
    if(!selectedGame) return;

    games[selectedGame].forEach((a,i)=>{
        const div=document.createElement("div");
        div.className="achievement "+a.tier;

        const clicked = a.completed ? "clicked" : "";

        div.innerHTML=`
        <span class="deleteAch" onclick="deleteAchievement(${i})">✖</span>
        <strong>${a.name}</strong>
        <div class="small">${a.how}</div>

        <select onchange="changeTier(${i},this.value)">
            <option value="bronze" ${a.tier==="bronze"?"selected":""}>Bronze</option>
            <option value="silver" ${a.tier==="silver"?"selected":""}>Silver</option>
            <option value="gold" ${a.tier==="gold"?"selected":""}>Gold</option>
            <option value="platinum" ${a.tier==="platinum"?"selected":""}>Platinum</option>
        </select>

        <button class="achieveBtn ${clicked}" onclick="markAchievement(this, ${i})"></button>
        `;

        wrap.appendChild(div);
    });

    updateTopBarCounters();
}

// Achievement Button
function markAchievement(btn, index){
    const achievement = games[selectedGame][index];
    if(!achievement.completed){
        achievement.completed = true;
        btn.classList.add("clicked");
        save();
        updateTopBarCounters();
    }
}

// Update Top Bar Counters
function updateTopBarCounters(){
    let bronze = 0, silver = 0, gold = 0, platinum = 0;
    if(selectedGame){
        games[selectedGame].forEach(a=>{
            if(a.completed){
                if(a.tier==="bronze") bronze++;
                else if(a.tier==="silver") silver++;
                else if(a.tier==="gold") gold++;
                else if(a.tier==="platinum") platinum++;
            }
        });
    }
    document.getElementById("bronzeCounter").textContent = `Bronze: ${bronze}`;
    document.getElementById("silverCounter").textContent = `Silver: ${silver}`;
    document.getElementById("goldCounter").textContent = `Gold: ${gold}`;
    document.getElementById("platinumCounter").textContent = `Platinum: ${platinum}`;
}

// Add Achievement
function addAchievement(){
    if(!selectedGame) return;

    const name=prompt("Achievement name?");
    if(!name) return;
    const how=prompt("How to achieve it?")||"";

    games[selectedGame].push({
        name,
        how,
        tier:"bronze",
        completed:false
    });

    save();
    renderAchievements();
}

function deleteAchievement(i){
    games[selectedGame].splice(i,1);
    save();
    renderAchievements();
}

function changeTier(i,val){
    games[selectedGame][i].tier=val;
    save();
    renderAchievements();
}

// ===== Password Save/Load System =====
function saveToPassword(){
    const jsonStr = JSON.stringify(games);
    // encode as base64 to make it safe as a "password"
    const password = btoa(unescape(encodeURIComponent(jsonStr)));
    prompt("Copy this password to save your data:", password);
}

function loadFromPassword(){
    const password = prompt("Paste your saved password:");
    if(!password) return;
    try {
        const jsonStr = decodeURIComponent(escape(atob(password)));
        const loadedGames = JSON.parse(jsonStr);
        if(typeof loadedGames === "object"){
            games = loadedGames;
            save();
            renderGames();
            alert("Data loaded successfully!");
        } else {
            alert("Invalid password.");
        }
    } catch(e){
        alert("Invalid password.");
    }
}

renderGames();

</script>

</body>
</html>
